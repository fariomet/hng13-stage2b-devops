<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TicketApp (React)</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #0b1020;
      --surface: #11162a;
      --muted: #8a90a2;
      --text: #e8ecf8;
      --primary: #6ea8ff;
      --green: #22c55e;
      --amber: #f59e0b;
      --gray: #9ca3af;
      --danger: #ef4444;
      --maxw: 1440px;
      --radius: 14px;
      --shadow: 0 10px 30px rgba(0,0,0,0.35);
    }
    * { 
    box-sizing: border-box; }
    html, body { margin:0; height:100%; 
    background: var(--bg); 
    color: var(--text); 
    font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; 
  }
    a { 
      color: inherit; text-decoration: none; 
    }
    button { cursor: pointer; }
    .container { 
      max-width: var(--maxw); 
      margin: 0 auto; 
      padding: 0 24px; 
    }
    header { 
      position: sticky; 
      top:0; z-index: 50; backdrop-filter: blur(6px); background: rgba(11,16,32,0.7); 
      border-bottom: 1px solid rgba(255,255,255,0.06); 
    }
    .nav { 
      display:flex; align-items:center; justify-content:space-between; height:64px; 
    }
    .brand { display:flex; 
      gap:10px; 
      align-items:center; font-weight:700; letter-spacing:0.4px; 
    }
    .brand .dot { 
      width:10px; 
      height:10px; border-radius:999px; background: var(--primary); box-shadow:0 0 0 4px rgba(110,168,255,0.2); 
    }
    .navlinks { 
      display:flex; 
      gap:16px; 
    }
    .navlinks a, .navlinks button { padding:8px 12px; border-radius:10px; 
      border:1px solid transparent; background: transparent; color: var(--text); 
    }
    .navlinks a:hover, .navlinks button:hover { 
      background: rgba(255,255,255,0.06); 
    }
    .btn { 
      background: var(--primary); color:#0b1020; 
      border:none; 
      padding:10px 16px; border-radius:12px; font-weight:600; 
    }
    .btn.secondary { 
      background: transparent; color: var(--text); 
      border:1px solid rgba(255,255,255,0.12); 
    }
    main { 
      min-height: calc(100vh - 220px); 
    }
    footer { 
      border-top:1px solid rgba(255,255,255,0.06); 
      padding:24px 0; 
      color: var(--muted); 
    }

    /* Hero */
    .hero { 
      position: relative; overflow: hidden; 
      padding: 72px 0 80px; 
    }
    .hero .bg { 
      position:absolute; 
      inset:0; background: radial-gradient(1200px 600px at 20% -10%, rgba(110,168,255,0.35), transparent), radial-gradient(900px 500px at 90% -20%, rgba(34,197,94,0.18), transparent); pointer-events: none; 
      z-index: 0; 
    }
    .hero .circle { position:absolute; 
      width:180px; 
      height:180px; border-radius:999px; background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.6), rgba(110,168,255,0.4)); 
      top:20px; 
      right:6%; 
      filter: blur(2px); 
      opacity:0.6; 
      z-index: 1; 
    }
    .hero .circle2 { position:absolute; 
      width:90px; 
      height:90px; border-radius:999px; background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.5), rgba(34,197,94,0.35)); 
      bottom:18%; 
      left:8%; 
      opacity:0.55; z-index: 1; 
    }
    .hero .content { position:relative; 
      z-index: 2; 
      display:grid; 
      gap:18px; 
      text-align:center; 
    }
    .wave { 
      position:absolute; bottom:-1px; 
      left:0; 
      right:0; 
      height:120px; 
      z-index: 0; 
      pointer-events: none; 
    }
    .hero p { 
      color: var(--muted); 
      margin:0 auto;
      max-width: 820px; 
    }
    .hero h1 { 
      font-size: clamp(28px, 4.5vw, 48px); 
      margin:0; 
    }
    .cta { 
      display:flex; 
      gap:12px; justify-content:center; flex-wrap:wrap; margin-top:12px; 
    }

    /* Cards */
    .grid { 
      display:grid; 
      gap:16px; 
    }
    @media(
      min-width: 768px){ .grid.cols-3 { grid-template-columns: repeat(3, 1fr); } 
    }
    .card { 
      background: var(--surface); border:1px solid rgba(255,255,255,0.06); 
      border-radius: var(--radius); padding:16px; 
      box-shadow: var(--shadow); 
    }
    .shadow-soft { 
      box-shadow: 0 6px 18px rgba(0,0,0,0.25); 
    }

    /* Forms */
    form { 
      display:grid; 
      gap:12px; }
    label { 
      font-weight:600; 
    }
    input, select, textarea { width:100%; 
      background:#0d1326; 
      color:var(--text); border:1px solid rgba(255,255,255,0.12); border-radius:10px; padding:10px 12px; outline:none; 
    }
    input:focus, select:focus, textarea:focus { 
      border-color: var(--primary); box-shadow: 0 0 0 4px rgba(110,168,255,0.15); 
    }
    .error { 
      color:#fecaca; font-size: 12px; 
    }

    /* Status tags */
    .tag { 
      display:inline-flex; align-items:center; 
      gap:6px; 
      padding:4px 8px; border-radius:999px; font-size:12px; 
      border:1px solid rgba(255,255,255,0.1); 
    }
    .tag.open { 
      background: rgba(34,197,94,0.12); 
      color:#86efac; 
    }
    .tag.in_progress { 
      background: rgba(245,158,11,0.12); 
      color:#fcd34d; }
    .tag.closed { 
      background: rgba(156,163,175,0.12); 
      color:#e5e7eb; 
    }

    /* Toasts */
    .toasts { 
      position: fixed; 
      top: 12px; 
      right: 12px; 
      display:grid; 
      gap:8px; 
      z-index:9999; 
    }
    .toast { 
      background: #0d1326; 
      color: var(--text); 
      border:1px solid rgba(255,255,255,0.12); 
      padding:10px 12px; border-radius:10px; box-shadow: var(--shadow); 
    }

    /* Responsive nav */
    .menu { 
      display:none; 
    }
    @media(max-width: 640px){ 
      .navlinks { 
        display:none; 
      } 
      .menu{ 
        display:block; 
      } 
    }
  </style>
</head>
<body>
  <div id="root"></div>
  <div class="toasts" id="toasts" aria-live="polite" aria-atomic="true"></div>

  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <script type="text/babel">
    const { useState, useEffect, useMemo } = React;

    const ROUTES = {
      '/': 'Landing',
      '/auth/login': 'Login',
      '/auth/signup': 'Signup',
      '/dashboard': 'Dashboard',
      '/tickets': 'Tickets',
    };

    const allowedStatuses = ['open','in_progress','closed'];
    const SESSION_KEY = 'ticketapp_session';
    const TICKETS_KEY = 'ticketapp_tickets';

    function getSession(){
      try{ return JSON.parse(localStorage.getItem(SESSION_KEY)); }catch{ return null; }
    }
    function setSession(sess){ localStorage.setItem(SESSION_KEY, JSON.stringify(sess)); }
    function clearSession(){ localStorage.removeItem(SESSION_KEY); }

    function getTickets(){ try{ return JSON.parse(localStorage.getItem(TICKETS_KEY)) || []; }catch{ return []; } }
    function setTickets(list){ localStorage.setItem(TICKETS_KEY, JSON.stringify(list)); }

    function toast(msg, type='info'){
      const wrap = document.getElementById('toasts');
      const el = document.createElement('div');
      el.className = 'toast';
      el.textContent = msg;
      wrap.appendChild(el);
      setTimeout(()=>{ el.remove(); }, 2600);
    }

    function useHashRoute(){
      const [hash, setHash] = useState(location.hash.replace('#','') || '/');
      useEffect(()=>{
        const onHash = ()=> setHash(location.hash.replace('#','') || '/');
        addEventListener('hashchange', onHash);
        return ()=> removeEventListener('hashchange', onHash);
      },[]);
      return [hash, (p)=>{ location.hash = p; }];
    }

    function Guard({ children }){
      const sess = getSession();
      useEffect(()=>{
        if(!sess){ location.hash = '/auth/login'; toast('Your session has expired — please log in again.','error'); }
      },[]);
      return sess ? children : null;
    }

    function Layout({ children, onLogout }){
      const sess = getSession();
      return (
        <>
          <header>
            <div className="container nav">
              <div className="brand" role="banner" aria-label="TicketApp">
                <div className="dot" aria-hidden="true"></div>
                <a href="#/">TicketApp</a>
              </div>
              <button className="menu btn secondary" aria-label="Menu" onClick={()=>toast('Use navigation links on larger screens.')}>☰</button>
              <nav className="navlinks" aria-label="Primary">
                <a href="#/">Home</a>
                <a href="#/dashboard">Dashboard</a>
                <a href="#/tickets">Tickets</a>
                {sess ? <button className="btn secondary" onClick={onLogout}>Logout</button> : <a className="btn" href="#/auth/login">Login</a>}
              </nav>
            </div>
          </header>
          <main>
            {children}
          </main>
          <footer>
            <div className="container">© {new Date().getFullYear()} TicketApp. All rights reserved.</div>
          </footer>
        </>
      );
    }

    function Hero(){
      return (
        <section className="hero" aria-label="Welcome">
          <div className="bg" aria-hidden="true"></div>
          <div className="circle" aria-hidden="true"></div>
          <div className="circle2" aria-hidden="true"></div>
          <div className="container content">
            <h1>Ship better support with TicketApp</h1>
            <p>Multi-framework demo app for managing tickets with a consistent, accessible design. Explore the same UX built in React, Vue, and Twig.</p>
            <div className="cta">
              <a className="btn" href="#/auth/login">Login</a>
              <a className="btn secondary" href="#/auth/signup">Get Started</a>
            </div>
          </div>
          <svg className="wave" viewBox="0 0 1440 120" preserveAspectRatio="none" aria-hidden="true">
            <path fill="#0b1020" d="M0,32L40,58.7C80,85,160,139,240,149.3C320,160,400,128,480,106.7C560,85,640,75,720,80C800,85,880,107,960,112C1040,117,1120,107,1200,90.7C1280,75,1360,53,1400,42.7L1440,32L1440,0L1400,0C1360,0,1280,0,1200,0C1120,0,1040,0,960,0C880,0,800,0,720,0C640,0,560,0,480,0C400,0,320,0,240,0C160,0,80,0,40,0L0,0Z"/>
          </svg>
        </section>
      );
    }

    function AuthForm({ mode='login', onSuccess }){
      const [email, setEmail] = useState('');
      const [password, setPassword] = useState('');
      const [errors, setErrors] = useState({});
      function validate(){
        const e={};
        if(!email || !/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(email)) e.email='Valid email required';
        if(!password || password.length<6) e.password='Password must be at least 6 characters';
        setErrors(e); return Object.keys(e).length===0;
      }
      function submit(ev){ ev.preventDefault(); if(!validate()) { toast('Invalid credentials.','error'); return; }
        if(mode==='signup'){
          const sess = { token: 'demo-token', user: { email } };
          setSession(sess);
          toast('Account created. Welcome!');
          onSuccess();
        } else {
          // Simulate login: accept any email/password that passes validation
          const sess = { token: 'demo-token', user: { email } };
          setSession(sess);
          toast('Logged in successfully.');
          onSuccess();
        }
      }
      return (
        <div className="container" style={{padding:'24px 0'}}>
          <div className="card" role="region" aria-label={mode==='signup'?'Signup':'Login'}>
            <h2 style={{marginTop:0}}>{mode==='signup'?'Create your account':'Welcome back'}</h2>
            <form onSubmit={submit} noValidate>
              <div>
                <label htmlFor="email">Email</label>
                <input id="email" type="email" value={email} onChange={e=>setEmail(e.target.value)} aria-invalid={!!errors.email} aria-describedby="email-err" />
                {errors.email && <div id="email-err" className="error">{errors.email}</div>}
              </div>
              <div>
                <label htmlFor="password">Password</label>
                <input id="password" type="password" value={password} onChange={e=>setPassword(e.target.value)} aria-invalid={!!errors.password} aria-describedby="pwd-err" />
                {errors.password && <div id="pwd-err" className="error">{errors.password}</div>}
              </div>
              <div style={{display:'flex', gap:8, alignItems:'center'}}>
                <button className="btn" type="submit">{mode==='signup'?'Create account':'Login'}</button>
                {mode==='login' ? (
                  <a className="btn secondary" href="#/auth/signup">Create account</a>
                ) : (
                  <a className="btn secondary" href="#/auth/login">Back to login</a>
                )}
              </div>
            </form>
          </div>
        </div>
      );
    }

    function Dashboard(){
      const tickets = getTickets();
      const stats = useMemo(()=>({
        total: tickets.length,
        open: tickets.filter(t=>t.status==='open').length,
        resolved: tickets.filter(t=>t.status==='closed').length,
      }), [tickets.length]);
      return (
        <div className="container" style={{padding:'24px 0'}}>
          <div className="grid cols-3">
            <div className="card"><div style={{opacity:.7}}>Total tickets</div><div style={{fontSize:28, fontWeight:700}}>{stats.total}</div></div>
            <div className="card"><div style={{opacity:.7}}>Open</div><div style={{fontSize:28, fontWeight:700, color:'#86efac'}}>{stats.open}</div></div>
            <div className="card"><div style={{opacity:.7}}>Resolved</div><div style={{fontSize:28, fontWeight:700, color:'#e5e7eb'}}>{stats.resolved}</div></div>
          </div>
          <div className="card" style={{marginTop:16}}>
            <h3 style={{marginTop:0}}>Quick actions</h3>
            <div style={{display:'flex', gap:8, flexWrap:'wrap'}}>
              <a className="btn" href="#/tickets">Manage Tickets</a>
            </div>
          </div>
        </div>
      );
    }

    function TicketForm({ initial, onSave, onCancel }){
      const [title, setTitle] = useState(initial?.title||'');
      const [status, setStatus] = useState(initial?.status||'open');
      const [description, setDescription] = useState(initial?.description||'');
      const [errors, setErrors] = useState({});
      function validate(){
        const e={};
        if(!title.trim()) e.title='Title is required';
        if(!allowedStatuses.includes(status)) e.status='Invalid status';
        if(description.length>1000) e.description='Description must be at most 1000 characters';
        setErrors(e); return Object.keys(e).length===0;
      }
      function submit(ev){ ev.preventDefault(); if(!validate()){ toast('Please fix validation errors.','error'); return; }
        onSave({ ...initial, title:title.trim(), status, description: description.trim() });
      }
      return (
        <form onSubmit={submit} noValidate>
          <div>
            <label htmlFor="t-title">Title</label>
            <input id="t-title" value={title} onChange={e=>setTitle(e.target.value)} aria-invalid={!!errors.title} aria-describedby="title-err" />
            {errors.title && <div id="title-err" className="error">{errors.title}</div>}
          </div>
          <div>
            <label htmlFor="t-status">Status</label>
            <select id="t-status" value={status} onChange={e=>setStatus(e.target.value)} aria-invalid={!!errors.status} aria-describedby="status-err">
              <option value="open">open</option>
              <option value="in_progress">in_progress</option>
              <option value="closed">closed</option>
            </select>
            {errors.status && <div id="status-err" className="error">{errors.status}</div>}
          </div>
          <div>
            <label htmlFor="t-desc">Description</label>
            <textarea id="t-desc" rows="4" value={description} onChange={e=>setDescription(e.target.value)} aria-invalid={!!errors.description} aria-describedby="desc-err"></textarea>
            {errors.description && <div id="desc-err" className="error">{errors.description}</div>}
          </div>
          <div style={{display:'flex', gap:8}}>
            <button className="btn" type="submit">Save</button>
            <button className="btn secondary" type="button" onClick={onCancel}>Cancel</button>
          </div>
        </form>
      );
    }

    function TicketList(){
      const [tickets, setList] = useState(getTickets());
      const [editing, setEditing] = useState(null);
      const [creating, setCreating] = useState(false);

      function refresh(){ setList(getTickets()); }
      function create(ticket){
        const list = getTickets();
        const id = (Date.now()+Math.random()).toString(36);
        const t = { id, ...ticket };
        setTickets([t, ...list]);
        toast('Ticket created.');
        setCreating(false);
        refresh();
      }
      function update(ticket){
        const list = getTickets().map(x=> x.id===ticket.id? ticket : x);
        setTickets(list);
        toast('Ticket updated.');
        setEditing(null);
        refresh();
      }
      function remove(id){
        if(!confirm('Delete this ticket?')) return;
        const list = getTickets().filter(x=> x.id!==id);
        setTickets(list);
        toast('Ticket deleted.');
        refresh();
      }

      return (
        <div className="container" style={{padding:'24px 0'}}>
          <div className="card" style={{marginBottom:16}}>
            {creating ? (
              <>
                <h3 style={{marginTop:0}}>New Ticket</h3>
                <TicketForm onSave={create} onCancel={()=>setCreating(false)} />
              </>
            ) : (
              <div style={{display:'flex', justifyContent:'space-between', alignItems:'center'}}>
                <h3 style={{marginTop:0}}>Tickets</h3>
                <button className="btn" onClick={()=>setCreating(true)}>Create Ticket</button>
              </div>
            )}
          </div>

          <div className="grid" style={{gridTemplateColumns:'repeat(auto-fill, minmax(280px, 1fr))'}}>
            {tickets.length===0 && <div className="card">No tickets yet.</div>}
            {tickets.map(t=> (
              <div key={t.id} className="card shadow-soft" role="article" aria-labelledby={`t-${t.id}`}> 
                {editing===t.id ? (
                  <TicketForm initial={t} onSave={update} onCancel={()=>setEditing(null)} />
                ) : (
                  <>
                    <div style={{display:'flex', justifyContent:'space-between', gap:8, alignItems:'baseline'}}>
                      <h4 id={`t-${t.id}`} style={{margin:'4px 0'}}>{t.title}</h4>
                      <span className={"tag "+t.status}>{t.status.replace('_',' ')}</span>
                    </div>
                    <p style={{marginTop:8, color:'var(--muted)'}}>{t.description || 'No description.'}</p>
                    <div style={{display:'flex', gap:8, marginTop:8}}>
                      <button className="btn secondary" onClick={()=>setEditing(t.id)}>Edit</button>
                      <button className="btn secondary" onClick={()=>remove(t.id)} style={{borderColor:'rgba(255,255,255,0.2)'}}>Delete</button>
                    </div>
                  </>
                )}
              </div>
            ))}
          </div>
        </div>
      );
    }

    function App(){
      const [route, nav] = useHashRoute();
      useEffect(()=>{ if(!location.hash) nav('/'); }, []);
      function logout(){ clearSession(); toast('Logged out.'); nav('/'); }

      const sess = getSession();
      const isProtected = route==='/dashboard' || route==='/tickets';
      useEffect(()=>{
        if(isProtected && !sess){ nav('/auth/login'); toast('Your session has expired — please log in again.','error'); }
      }, [route]);

      let content = null;
      if(route==='/') content = (<>
        <Hero/>
        <div className="container" style={{padding:'8px 0 24px'}}>
          <div className="grid cols-3">
            <div className="card"><h3 style={{marginTop:0}}>Fast</h3><p style={{color:'var(--muted)'}}>Quickly manage your support tickets with a clean, responsive UI.</p></div>
            <div className="card"><h3 style={{marginTop:0}}>Reliable</h3><p style={{color:'var(--muted)'}}>Validation, toasts, and guards keep your data safe and clear.</p></div>
            <div className="card"><h3 style={{marginTop:0}}>Accessible</h3><p style={{color:'var(--muted)'}}>Semantic markup, focus states, and high-contrast colors.</p></div>
          </div>
        </div>
      </>);
      else if(route==='/auth/login') content = <AuthForm mode="login" onSuccess={()=>nav('/dashboard')} />;
      else if(route==='/auth/signup') content = <AuthForm mode="signup" onSuccess={()=>nav('/dashboard')} />;
      else if(route==='/dashboard') content = <Guard><Dashboard/></Guard>;
      else if(route==='/tickets') content = <Guard><TicketList/></Guard>;
      else content = <div className="container" style={{padding:'24px 0'}}>Not found</div>;

      return <Layout onLogout={logout}>{content}</Layout>;
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App/>);
  </script>
</body>
</html>
